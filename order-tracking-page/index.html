<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Order Tracking | IE104 Restaurant</title>

    <!-- CSS global -->
    <link rel="stylesheet" href="../style/reset.css" />
    <link rel="stylesheet" href="../style/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Libre+Bodoni:ital,wght@0,400..700;1,400..700&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap"
      rel="stylesheet"
    />

    <!-- Global Animation System -->
    <link rel="stylesheet" href="../style/animations.css" />
    <script src="../assets/script/scroll-animations.js"></script>

    <!-- CSS header -->
    <link rel="stylesheet" href="../partials/header.css" />
    <!-- CSS footer -->
    <link rel="stylesheet" href="../partials/footer.css" />

    <!-- Font Awesome -->
    <script
      src="https://kit.fontawesome.com/eef96f1e29.js"
      crossorigin="anonymous"
    ></script>

    <!-- Global Loading System -->
    <script src="../assets/script/global-loader.js"></script>

    <!-- link header and footer -->
    <script src="../assets/script/include-partials.js" defer></script>
    <script src="../assets/script/header.js"></script>

    <!-- Advanced Features - Core Utilities -->
    <script src="../assets/script/utils/constants.js"></script>
    <script src="../assets/script/utils/storage-manager.js"></script>
    <script src="../assets/script/utils/event-bus.js"></script>

    <!-- Advanced Features - Styles -->
    <link rel="stylesheet" href="../assets/style/features/dark-theme.css" />

    <!-- Order Tracking Page Styles -->
    <link rel="stylesheet" href="./order-tracking-page.css" />
  </head>

  <body>
    <!-- ========== HEADER ========== -->
    <div data-include="/partials/header.html"></div>

    <!-- ========== ORDER TRACKING PAGE CONTENT ========== -->
    <main class="tracking-page">
      <div class="tracking-page__container">
        <!-- Page Header -->
        <div class="tracking-page__header animate-fade">
          <h1 class="tracking-page__title">Track Your Order</h1>
          <p class="tracking-page__subtitle">Real-time updates on your order status</p>
        </div>

        <!-- Order Tracker Container -->
        <div id="order-tracker-container"></div>

        <!-- No Orders Message -->
        <div id="no-orders-message" class="no-orders" style="display: none;">
          <div class="no-orders__icon">ðŸ“¦</div>
          <h2 class="no-orders__title">No Active Orders</h2>
          <p class="no-orders__text">Place an order to track it here!</p>
          <a href="../menupage/index.html" class="no-orders__btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 3h18v18H3zM3 9h18M9 21V9"></path>
            </svg>
            Browse Menu
          </a>
        </div>
      </div>
    </main>

    <!-- ========== FOOTER ========== -->
    <div data-include="/partials/footer.html"></div>

    <!-- Advanced Features Scripts -->
    <script src="../assets/script/features/dark-mode-toggle.js"></script>
    <script src="../assets/script/features/order-tracking-manager.js"></script>

    <!-- Order Tracking Page Script -->
    <script>
      // Initialize order tracking page
      document.addEventListener('DOMContentLoaded', () => {
        const container = document.getElementById('order-tracker-container');
        const noOrdersMsg = document.getElementById('no-orders-message');

        // Get active orders
        const orders = StorageManager.get(STORAGE_KEYS.ORDER_HISTORY, []);
        const activeOrders = orders.filter(order => order.status !== 'delivered');

        if (activeOrders.length === 0) {
          noOrdersMsg.style.display = 'block';
          return;
        }

        // Render each order tracker
        activeOrders.forEach(order => {
          if (window.OrderTrackingManager) {
            const trackerHTML = window.OrderTrackingManager.createTrackerElement(order.id);
            container.innerHTML += trackerHTML;
          }
        });

        console.log('âœ… Order tracking page initialized');
      });
    </script>
  </body>
</html>
